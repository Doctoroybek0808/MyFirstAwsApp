@model Application.BankStatementsWithQr.AccountTransactionRecord.Models.AccountTransactionRecordWithQr
@{
    Layout = null;
}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <title>Справка о движении средств по счёту</title>

    <!-- ВАЖНО: используем @page, а не padding у body/container -->
    <style>
        /* Страница */
        @page {
            size: A4 portrait;
            margin: 15mm 10mm; /* поля страницы */
        }

        /* Сброс (минимальный, поддерживаемый pdfHTML) */
        * { box-sizing: border-box; }
        html, body { margin: 0; padding: 0; }
        body { font-family: sans-serif; font-size: 12px; line-height: 1.3; }

        /* Контейнер фиксированной ширины по A4 с внутренними отступами */
        .container {
            width: 190mm;      /* 210mm - (поля слева+справа) с небольшим запасом */
            margin: 0 auto;
        }

        /* Заголовок */
        .header {
            display: table;            /* вместо flex для предсказуемости */
            width: 100%;
            border-bottom: 0.6mm solid #000;
            padding-bottom: 12mm;
            margin-bottom: 12mm;
        }
        .header__left,
        .header__right {
            display: table-cell;
            vertical-align: middle;
        }
        .header__left { width: 120mm; }
        .header__right { width: auto; text-align: right; }

        .header-logo { width: 80mm; }
        .header__right-title { font-weight: 600; font-size: 12px; }
        .header__right-subtitle { color: #7E7E7E; font-size: 12px; margin-top: 2mm; }

        /* Титул */
        .title {
            font-weight: 700;
            font-size: 18px;
            line-height: 1.1;
            margin: 4mm 0 5mm 0;
            page-break-inside: avoid;
        }

        /* Блок реквизитов */
        .info {
            border-bottom: 0.3mm solid #D8D8D8;
            padding-bottom: 6mm;
            margin-bottom: 7mm;
        }
        .info p { font-weight: 500; font-size: 12px; margin: 1.5mm 0; }

        /* Остатки за период */
        .row { display: table; width: 100%; margin-bottom: 7mm; }
        .column { display: table-cell; width: 50%; font-size: 12px; vertical-align: top; }
        .column--right { text-align: right; }

        /* Таблица движений */
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
            word-wrap: break-word;
            margin-bottom: 15mm;
        }
        colgroup col:nth-child(1) { width: 40mm; }
        colgroup col:nth-child(2) { width: 65mm; }
        colgroup col:nth-child(3) { width: 30mm; }
        colgroup col:nth-child(4) { width: 30mm; }
        colgroup col:nth-child(5) { width: auto; }

        thead th {
            background: #F5F5F5;
            font-weight: 600;
            font-size: 12px;
            border: 0.3mm solid #000;
            padding: 3mm;
            text-align: left;
        }
        td {
            font-size: 12px;
            border: 0.3mm solid #000;
            padding: 3mm;
            vertical-align: top;        /* middle часто рендерится странно */
            text-align: left;
        }
        .number { text-align: right; }

        /* Итого */
        .total-row td { font-weight: 700; background: #EDEDED; }
        .avoid-break { page-break-inside: avoid; }

        /* Подчеркивание в номере счёта контрагента */
        .u { text-decoration: underline; }

        /* Подвал */
        .footer {
            border-top: 0.3mm solid #000;
            padding-top: 6mm;
            page-break-inside: avoid;
        }
        .footer-top {
            display: table;
            width: 100%;
            border-bottom: 0.3mm solid #000;
            padding-bottom: 5mm;
            margin-bottom: 6mm;
        }
        .footer-top__text, .footer-top__qr {
            display: table-cell; vertical-align: top;
        }
        .footer-top__text {
            width: 120mm; font-weight: 600; font-size: 10px;
            padding-right: 5mm;
        }
        .qr-code { width: 30mm; height: 30mm; object-fit: contain; }

        .footer-contacts { font-size: 11px; }
        .footer-contacts a { color: #000; text-decoration: none; }
        .footer-contacts span { font-weight: 600; }
    </style>
</head>
<body>
<div class="container">
    <div class="header avoid-break">
        <div class="header__left">
            <div class="header-logo">
                <!-- ваш логотип как в исходнике -->
                <svg width="335" height="47" viewBox="0 0 335 47" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <!-- …paths… (оставил как у вас) -->
                </svg>
            </div>
        </div>
        <div class="header__right">
            <div class="header__right-title">
                Дата создания документа: @Model.Header.CreatedDate?.ToString("dd.MM.yyyy")
            </div>
            <div class="header__right-subtitle">Документ действителен на дату создания</div>
        </div>
    </div>

    <h1 class="title avoid-break">
        Справка о движениях средств по счету<br/>
        за период @Model.Header.DateFrom.ToString("dd.MM.yyyy")–@Model.Header.DateTo.ToString("dd.MM.yyyy")
    </h1>

    <div class="info">
        <p>@Model.Header.ContragentSName</p>
        <p>МФО @Model.Header.BranchNumber — @Model.Header.BranchName</p>
        <p>Расчётный счёт № @Model.Header.AccountNo</p>
    </div>

    <div class="row avoid-break">
        <div class="column">
            <p><b>Остаток на начало периода:&nbsp;</b><span>@Model.Header.BegBalance</span></p>
        </div>
        <div class="column column--right">
            <p><b>Остаток на конец периода:&nbsp;</b><span>@Model.Header.EndBalance</span></p>
        </div>
    </div>

    <table>
        <colgroup>
            <col /><col /><col /><col /><col />
        </colgroup>
        <thead>
            <tr>
                <th>Дата и номер<br/>документа</th>
                <th>Получатель</th>
                <th>Оборот<br/>Дебет</th>
                <th>Оборот<br/>Кредит</th>
                <th>Назначение платежа</th>
            </tr>
        </thead>
        <tbody>
        @foreach (var item in Model.BodyItem)
        {
            <tr>
                <td>
                    <div><b>@item.DocumentDate.ToString("dd.MM.yyyy")</b></div>
                    <div>№@item.DocumentNo</div>
                </td>
                <td>
                    <div><b>@item.CorrContragentName</b></div>
                    <div>МФО @item.CorrBankId</div>
                    <div class="u">@item.CorrAccountNo</div>
                </td>
                <td class="number">@item.DTFormat</td>
                <td class="number">@item.KTFormat</td>
                <td>@item.PlatPurpose</td>
            </tr>
        }
            <tr class="total-row">
                <td></td>
                <td><b>Итого оборот за период:</b></td>
                <td class="number"><b>@Model.Header.TotalDebit</b></td>
                <td class="number"><b>@Model.Header.TotalKredit</b></td>
                <td></td>
            </tr>
        </tbody>
    </table>

    <div class="footer">
        <div class="footer-top">
            <div class="footer-top__text">
                Данный документ является копией электронного документа, созданной с помощью интернет-банка и несёт информационный характер.
                <br/><br/>
                Для проверки достоверности сведений, указанных в копии электронного документа, отсканируйте QR-код с помощью мобильного устройства.
            </div>
            <div class="footer-top__qr" style="text-align:right;">
                <img
                    src="data:image/png;base64,@Model.Header.ImageBase64"
                    alt="QR" class="qr-code" />
            </div>
        </div>

        <div class="footer-contacts">
            <a href="tel:+998781408181"><span>Тел.:</span> +998 (78) 140-81-81</a>
            &nbsp;&nbsp;&nbsp;
            <a href="mailto:info@kapitalbank.uz"><span>E-mail:</span> info@kapitalbank.uz</a>
        </div>
    </div>
</div>
</body>
</html>

